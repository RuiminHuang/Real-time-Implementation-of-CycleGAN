## Descriptions of model structure

### 0. How to generate networks with different structures

#### Requirements
>Pytorch 1.4 or higher, only Pytorch is required, no other dependencies are needed.

#### Usage
>python3 main.py

#### Descriptions

In main.py, 1 teacher network, 1 student network, and 3 sub-networks of student networks are defined. 

We use config to define number of channels in each layer of the hidden layer.

* For a teacher network, or original CycleGAN generators,  the config is set to [64, 64, 64, 64, 64, 64, 64, 64, 64], which is relatively computationally intensive.

  ```python
  # Teacher network, which is original CycleGAN generator
  Teacher_Network = MyCycleGANGenerator(config=[64, 64, 64, 64, 64, 64, 64, 64])
  ```

* For a student network,  the config is set to [32, 32, 32, 32, 32, 32, 32, 32, 32], which is less computationally intensive.

  ```python
  # Student network
  Student_Network = MyCycleGANGenerator(config=[32, 32, 32, 32, 32, 32, 32, 32])
  ```

* For a sub-net of the student network, the config is [n1, n2, n3, n4, n5, n6, n8]. To balance computational complexity and hardware parallelism, n1-n8 can be selected as 16, 24, or 32, so there are 6561 (3 to the 8th power) sub-nets. Obviously, the sub-nets is also less computationally intensive than the student network.

  ```python
  # Sub_Network1
  Sub_Network1 = MyCycleGANGenerator(config=[16, 16, 16, 16, 16, 16, 16, 16])
  # Sub_Network2
  Sub_Network2 = MyCycleGANGenerator(config=[24, 16, 16, 16, 16, 16, 16, 16])
  # Sub_Network3
  Sub_Network3 = MyCycleGANGenerator(config=[24, 24, 16, 16, 16, 16, 16, 16])
  ```

  

### 1. Compare the structure of different networks generated by main.py

By exporting the networks as onnx files and opening them with netron app, some differences can be found.

The differences between Sub_Network1 and Sub_Network2, as well as between Sub_Network2 and Sub_Network3, are easy to recognize. The differences are marked in the figure with black rectangles.

![all_model](images/all_model.jpg)
